export const bool=t=>t==="true"?!0:t==="false"?!1:t instanceof Array?t.length>0:t instanceof Object?Object.keys(t).length>0:!1,str=t=>""+t,cmp=(()=>{const t=(e,n)=>{const r=typeof e;if(r===typeof n)switch(r){case"string":return e.localeCompare(n);case"object":if(e===n)return 0;if(e instanceof Array){const f=e.length,l=n.length;if(f<l)return-1;if(f>n)return 1;for(var i=0;i<f;){const g=t(e[i],n[i]);if(g!==0)return g;i+=1}return 0}else return-1;default:return e===n?0:e>n?1:-1}else return e===n?0:e>n?1:-1};return t})(),is=(t,...e)=>{for(var n=0;n<e.length;){if(t===e[n])return!0;n++}return!1},isDef=t=>t!==void 0,isValue=t=>t!==void 0&&t!=null,idem=t=>t,asMappable=t=>e=>e instanceof Array?e.map(n=>t(n)):t(e),callable=t=>t instanceof Function?t:()=>t,isMap=t=>t!==null&&(t instanceof Map||t instanceof Object&&!(t instanceof Array)),isList=t=>t instanceof Array,isIterator=t=>!1,isIterable=t=>t!==null&&t instanceof Object,Nothing=new String("Nothing"),swallow=(t,e)=>e,nop=()=>{},pipe=(t,...e)=>{for(var n=t,r=0;r<e.length;r++)n=e[r](n);return n},compose=(...t)=>{const e=t.length;if(e==2)return n=>t[1](t[0](n));if(e==3)return n=>t[2](t[1](t[0](n)));throw new window.Exception("Not supported")},memoize=(t,e=!0,n=void 0)=>{var r=void 0,o=void 0;return()=>{const i=n?n(e,e):o;return i!==e&&(o=n?n(e,i):o,e=o,r=t()),r}},freeze=t=>(t instanceof Object&&Object.freeze(t),t),state=(()=>{const t={};return(e,n=void 0)=>n===void 0?t[e]:(t[e]=n,n)})(),index=(t,e)=>{if(t instanceof Array)return t.indexOf(e);if(t instanceof Object){for(let n in t)if(t[n]===e)return n}return-1},access=(t,e)=>typeof t=="object"?typeof e=="string"?t[e]:e.reduce((n,r)=>typeof n=="object"?n[r]:void 0,t):void 0,slice=(t,e,n=void 0)=>t&&t instanceof Object?t instanceof Array?t.slice(e,n):Object.keys(t).slice(e,n).reduce((r,o)=>(r[o]=t[o],r),{}):void 0,max=(()=>{const t=(...e)=>e.length===1?e[0]instanceof Array?e[0].reduce((n,r)=>n===void 0?r:t(n,r)):e[0]:e.length===2?Math.max(t(e[0]),t(e[1])):e.reduce((n,r)=>n===void 0?r:t(n,r));return t})(),array=(t,e=null)=>{const n=new Array(t);for(;t;)t--,n[t]=e?e(t):t;return n},merge=(t,e,n=!1)=>{if(t==null)return e;if(e===null||t===e)return t;for(let r in e){const o=t[r],i=e[r];o===void 0||n===!0?t[r]=i:n instanceof Function&&(t[r]=n(t[r],i))}return t},range=(t,e,n=1,r=!1)=>{e===void 0&&(e=t,t=0);const o=Math.ceil(Math.max(0,(e-t)/n))+(r?1:0),i=new Array(o);var f=t;for(let l=0;l<o;l++)i[l]=f,f+=n;return i},sign=t=>t<0?-1:1,order=(t,e=10)=>Math.log(Math.abs(t))/Math.log(e),lerp=(t,e,n)=>(n=n===void 0?.5:n,t+(e-t)*n),prel=(t,e,n)=>(t-e)/(n-e),sinestep=t=>(Math.cos(Math.PI+Math.PI*t)+1)/2,smoothstep=t=>t*t*t*(t*(t*6-15)+10),smootherstep=t=>t*t*t*(t*(t*6-15)+10),clamp=(t,e,n)=>Math.max(e,Math.min(n,t)),round=(t,e=1,n=1)=>{const r=t/e;return(n<0?Math.floor(r):n>0?Math.ceil(r):Math.round(r))*e},min=(()=>{const t=(...e)=>e.length===1?e[0]instanceof Array?e[0].reduce((n,r)=>n===void 0?r:t(n,r)):e[0]:e.length===2?Math.min(t(e[0]),t(e[1])):e.reduce((n,r)=>n===void 0?r:t(n,r));return t})(),wrap=(t,e=10)=>{const n=Math.abs(e);return n===0||t===0?0:t>0?t%n:(n+t%n)%n},dist=(t,e)=>Math.abs(e-t),closestInOrder=(t,e,n=0)=>{var r=0;const o=t.length;for(var i=0;r<o;){const f=t[r];if(e===f)return e;if(e<f)return r===0?f:n===0?e-i<f-e?i:f:n<0?i:f;i=f,r+=1}return i},within=(t,e,n)=>e<=t&&t<=n,sub=(t,e)=>t instanceof Array?t[0]-t[1]:t-e,sq=t=>t*t,sqrt=t=>Math.sqrt(t),reldist=(t,e)=>(e-t)/e,circdist=(t,e)=>{const n=Math.abs(e-t)%1;return n>.5?1-n:n},factorial=t=>{for(var e=t;t>0;)e*=t--;return e},reducematches=(t,e,n,r=[])=>{let o=r,i=0,f=0,l;for(const g of t.matchAll(e))f!=g.index&&(l=n(o,t.substring(f,g.index),i++)),o=l===void 0?o:l,l=n(o,g,i++),f=g.index+g[0].length,o=l===void 0?o:l;return f!=t.length&&(l=n(o,t.substring(f),i++)),o=l===void 0?o:l,o},fromKebabCase=t=>t.split("-").map(e=>e.strip()),capitalize=t=>`${t.substr(0,1).toUpperCase()}${t.substr(1)}`,asNumber=t=>t==null?0:typeof t=="number"?isNaN(t)?0:t:t instanceof Date?t.getTime():0,safekey=(()=>{const t=new RegExp(`([^A-Za-z0-9 	
])`,"g"),e=new RegExp(`[ 	
]+`,"g");return(n,r="_")=>(""+n).trim().replace(t,"_").replace(e,r)})(),uid=()=>("000"+(Math.random()*46656|0).toString(36)).slice(-3)+("000"+(Math.random()*46656|0).toString(36)).slice(-3),style=(t,e)=>{for(var n in e)t.style[n]=e[n];return t},setattr=(t,e,n,r=0,o=void 0)=>{const i=typeof n;if(!o&&e.startsWith("on")){const f=e.toLowerCase();return t[f]!==void 0&&(t[f]=n),t}if(!o&e==="style"&&i==="object")r||t.setAttribute("style",""),Object.assign(t.style,n);else if(!o&&e==="value"&&t.value!==void 0)t.value=n||"";else if(!o&&e.startsWith("on")&&t[e]!==void 0)t[e]=n;else if(n==null)o?t.removeAttributeNS(o,e):t.removeAttribute(e);else{const f=i==="number"?`${n}`:i==="string"?n:JSON.stringify(n);if(r){const l=o?t.getAttributeNS(o,e):t.getAttribute(e),g=`${r<0&&l?l+" ":""}${f}${r>0&&l?" "+l:""}`;o?t.setAttributeNS(o,e,g):t.setAttribute(e,g)}else o?t.setAttributeNS(o,e,f):t.setAttribute(e,f)}return t},Empty="\u200B",bind=(t,e,n)=>(t[e]?t[e].push(n):t[e]=[n],t),unbind=(t,e,n)=>(t[e]&&(t[e]=t[e].filter(r=>r!==n)),t),trigger=(t,e,...n)=>t&&t[e]&&t[e].forEach(r=>r(...n)),defer=(t,e=0,n=void 0)=>e?window.setTimeout(n?r=>n()&&t(t):t,e):t(t),sprintf=(...t)=>{for(var e=function(y,d){for(var u=[];d>0;u[--d]=y);return u.join("")},n=0,r,o=t[n++],i=[],f,l,g,x;o;){if(f=/^[^\x25]+/.exec(o))i.push(f[0]);else if(f=/^\x25{2}/.exec(o))i.push("%");else if(f=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(o)){if((r=t[f[1]||n++])==null||r==null)return console.error("std.core.sprintf: too few arguments, expected ",t.length,"got",n-1,"in",t[0]);if(/[^s]/.test(f[7])&&typeof r!="number")return console.error("std.core.sprintf: expected number at",n-1,"got",r,"in",t[0]);switch(f[7]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":r=parseInt(r);break;case"e":r=f[6]?r.toExponential(f[6]):r.toExponential();break;case"f":r=f[6]?parseFloat(r).toFixed(f[6]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&f[6]?r.substring(0,f[6]):r;break;case"u":r=Math.abs(r);break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase();break}r=/[def]/.test(f[7])&&f[2]&&r>0?"+"+r:r,g=f[3]?f[3]=="0"?"0":f[3].charAt(1):" ",x=f[5]-String(r).length,l=f[5]?e(g,x):"",i.push(f[4]?r+l:l+r)}else return console.error("std.core.sprintf: reached state that shouldn't have been reached.");o=o.substring(f[0].length)}return i.join("")},strhash=(t,e=5381)=>{let n=5381,r=t.length;for(;r;)n=n*33^t.charCodeAt(--r);return n>>>0},numcode=(t,e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")=>{const n=[],r=e.length;let o=t;for(;o>0;){const i=o%r;o=Math.floor(o/r),n.unshift(e.charAt(i))}return n.join("")},md5=t=>{var e="0123456789abcdef";function n(w){var b,j="";for(b=0;b<=3;b++)j+=e.charAt(w>>b*8+4&15)+e.charAt(w>>b*8&15);return j}function r(w,b){var j=(w&65535)+(b&65535),A=(w>>16)+(b>>16)+(j>>16);return A<<16|j&65535}function o(w,b){return w<<b|w>>>32-b}function i(w,b,j,A,M,O){return r(o(r(r(b,w),r(A,O)),M),j)}function f(w,b,j,A,M,O,N){return i(b&j|~b&A,w,b,M,O,N)}function l(w,b,j,A,M,O,N){return i(b&A|j&~A,w,b,M,O,N)}function g(w,b,j,A,M,O,N){return i(b^j^A,w,b,M,O,N)}function x(w,b,j,A,M,O,N){return i(j^(b|~A),w,b,M,O,N)}function y(w){var b,j=(w.length+8>>6)+1,A=new Array(j*16);for(b=0;b<j*16;b++)A[b]=0;for(b=0;b<w.length;b++)A[b>>2]|=w.charCodeAt(b)<<b%4*8;return A[b>>2]|=128<<b%4*8,A[j*16-2]=w.length*8,A}var d,u=y(t),c=1732584193,a=-271733879,h=-1732584194,p=271733878,S,C,E,k;for(d=0;d<u.length;d+=16)S=c,C=a,E=h,k=p,c=f(c,a,h,p,u[d+0],7,-680876936),p=f(p,c,a,h,u[d+1],12,-389564586),h=f(h,p,c,a,u[d+2],17,606105819),a=f(a,h,p,c,u[d+3],22,-1044525330),c=f(c,a,h,p,u[d+4],7,-176418897),p=f(p,c,a,h,u[d+5],12,1200080426),h=f(h,p,c,a,u[d+6],17,-1473231341),a=f(a,h,p,c,u[d+7],22,-45705983),c=f(c,a,h,p,u[d+8],7,1770035416),p=f(p,c,a,h,u[d+9],12,-1958414417),h=f(h,p,c,a,u[d+10],17,-42063),a=f(a,h,p,c,u[d+11],22,-1990404162),c=f(c,a,h,p,u[d+12],7,1804603682),p=f(p,c,a,h,u[d+13],12,-40341101),h=f(h,p,c,a,u[d+14],17,-1502002290),a=f(a,h,p,c,u[d+15],22,1236535329),c=l(c,a,h,p,u[d+1],5,-165796510),p=l(p,c,a,h,u[d+6],9,-1069501632),h=l(h,p,c,a,u[d+11],14,643717713),a=l(a,h,p,c,u[d+0],20,-373897302),c=l(c,a,h,p,u[d+5],5,-701558691),p=l(p,c,a,h,u[d+10],9,38016083),h=l(h,p,c,a,u[d+15],14,-660478335),a=l(a,h,p,c,u[d+4],20,-405537848),c=l(c,a,h,p,u[d+9],5,568446438),p=l(p,c,a,h,u[d+14],9,-1019803690),h=l(h,p,c,a,u[d+3],14,-187363961),a=l(a,h,p,c,u[d+8],20,1163531501),c=l(c,a,h,p,u[d+13],5,-1444681467),p=l(p,c,a,h,u[d+2],9,-51403784),h=l(h,p,c,a,u[d+7],14,1735328473),a=l(a,h,p,c,u[d+12],20,-1926607734),c=g(c,a,h,p,u[d+5],4,-378558),p=g(p,c,a,h,u[d+8],11,-2022574463),h=g(h,p,c,a,u[d+11],16,1839030562),a=g(a,h,p,c,u[d+14],23,-35309556),c=g(c,a,h,p,u[d+1],4,-1530992060),p=g(p,c,a,h,u[d+4],11,1272893353),h=g(h,p,c,a,u[d+7],16,-155497632),a=g(a,h,p,c,u[d+10],23,-1094730640),c=g(c,a,h,p,u[d+13],4,681279174),p=g(p,c,a,h,u[d+0],11,-358537222),h=g(h,p,c,a,u[d+3],16,-722521979),a=g(a,h,p,c,u[d+6],23,76029189),c=g(c,a,h,p,u[d+9],4,-640364487),p=g(p,c,a,h,u[d+12],11,-421815835),h=g(h,p,c,a,u[d+15],16,530742520),a=g(a,h,p,c,u[d+2],23,-995338651),c=x(c,a,h,p,u[d+0],6,-198630844),p=x(p,c,a,h,u[d+7],10,1126891415),h=x(h,p,c,a,u[d+14],15,-1416354905),a=x(a,h,p,c,u[d+5],21,-57434055),c=x(c,a,h,p,u[d+12],6,1700485571),p=x(p,c,a,h,u[d+3],10,-1894986606),h=x(h,p,c,a,u[d+10],15,-1051523),a=x(a,h,p,c,u[d+1],21,-2054922799),c=x(c,a,h,p,u[d+8],6,1873313359),p=x(p,c,a,h,u[d+15],10,-30611744),h=x(h,p,c,a,u[d+6],15,-1560198380),a=x(a,h,p,c,u[d+13],21,1309151649),c=x(c,a,h,p,u[d+4],6,-145523070),p=x(p,c,a,h,u[d+11],10,-1120210379),h=x(h,p,c,a,u[d+2],15,718787259),a=x(a,h,p,c,u[d+9],21,-343485551),c=r(c,S),a=r(a,C),h=r(h,E),p=r(p,k);return n(c)+n(a)+n(h)+n(p)},ms=idem,effect=(t,e)=>swallow(e(t),t),hide=t=>swallow(t.classList.add("hidden"),t),show=t=>swallow(t.classList.remove("hidden"),t),keymap=(t,e)=>swallow(t.addEventListener("keydown",n=>e[n.key]?e[n.key](n,"down"):void 0),t),isIn=(t,e)=>index(t,e)!==-1,subdivide=(t=0,e=1,n=100,r=!0)=>n<=0?[]:t===e?r?[t]:[]:range(t,e,(e-t)/(n-(r?1:0)),r),nicer=(t,e=0,n=[1,5,10,20,25,50,100])=>{const r=Math.abs(t),o=sign(t),i=Math.pow(10,Math.floor(order(r))-1);return o*closestInOrder(n,r/i,e*o)*i},delta=(t,e=sub)=>t.reduce((n,r,o)=>(o>0&&n.push(e(r,t[o-1])),n),[]),sqdist=(t,e)=>sq(sub(t,e)),cnk=(t,e)=>factorial(t)/(factorial(e)*factorial(t-e)),fromPascalCase=t=>reducematches(t,/[A-Z][a-z]+/g,(e,n)=>{e.push(typeof n=="string"?n:n[0])}),until=(t,e,n=100,r=0)=>{const o=()=>t()?e(e):defer(o,n);return defer(o,r),o},type=t=>t===null?"null":t instanceof Array||t instanceof NodeList||t instanceof StyleSheetList?"list":typeof t,iter=(t,e=idem,n=idem,r=void 0,o=void 0)=>{if(t==null)return n(r,t,void 0);if(typeof t=="string"){var i=0,f=void 0,l=r;const x=t.length;for(;i<x;){f=t.charAt(i);const y=e(f,i,l,t);if(y===!1)return n(l,f,i,t);l=y===void 0?l:y,i+=1}return i===0?o:n(l,f,i,t)}else if(typeof t=="object"){var f=void 0,l=r;if(isIterator(t)){var i=0;for(let u of t){const c=e(u,i,l,t);if(c===!1)return n(l,u,i,t);l=c===void 0?l:c,i+=1}return i===0?o:n(l,f,i,t)}else if(t instanceof Array||t instanceof NodeList||t instanceof StyleSheetList){var i=0;const u=t.length;for(;i<u;){f=t[i];const c=e(f,i,l,t);if(c===!1)return n(l,f,i,t);l=c===void 0?l:c,i+=1}return i===0?o:n(l,f,i,t)}else{var g=void 0,i=0;for(g in t){f=t[g];const u=e(f,g,l,t);if(u===!1)return n(l,f,g,t);l=u===void 0?l:u,i++}return i==0?o:n(l,f,void 0,t)}}else return n(e(t,void 0,r))},s=t=>ms(t*1e3),showhide=(t,e)=>e?show(t):hide(t),empty=t=>t==null?t:t instanceof Array?[]:type(t)==="list"?[]:type(t)==="object"?{}:typeof t=="string"?"":t,eq=(()=>{const t=(e,n)=>{if(e===n)return!0;const r=type(e),o=type(n);if(r===o)switch(r){case"string":return e==n;case"list":const f=e.length,l=n.length;if(f!==l)return!1;for(var i=0;i<f;){if(!t(e[i],n[i]))return!1;i+=1}return!0;case"object":return e===n;default:return e==n}else return e==n};return t})(),maptype=(t,e)=>callable(e[type(t)]||e._||idem)(t),items=(t,e=!0)=>{let n=!1;switch(type(t)){case"list":n=!0;case"object":const r=[];let o=0;if(e)for(let i in t)r[o++]=[n?o:i,t[i]];else for(let i in t)r[o++]={key:i,value:t[i]};return r;default:return[]}},has=(t,e)=>{switch(type(t)){case"list":return t.indexOf(e)!==-1;case"object":for(let n in t)if(t[n]===e)return!0;return!1;default:return!1}},ensure=(t,e)=>{switch(type(t)){case"list":if(t.indexOf(e)===-1){const o=t.slice();return o.push(e),o}else return t;case"object":let n=0;for(let o in t){if(t[o]===e)return t;n++}for(;t[n];)n++;const r={};return Object.assign(r,t),r[n]=e,r;default:return t}},remove=(t,e)=>{switch(type(t)){case"list":return t.indexOf(e)===-1?t:t.filter(r=>r!==e);case"object":let n=!1;for(let r in t)if(t[r]===e){n=!0;break}if(n){const r={};for(let o in t)t[o]!==e&&(r[o]=t[o]);return r}else return t;default:return t}},reverse=t=>{switch(type(t)){case"list":const n=t.length;return array(n,i=>t[n-i-1]);case"object":const r=Object.keys(t),o={};for(let i=r.length-1;i>=0;i--){const f=r[i];o[f]=t[f]}return o;default:return t}},indexLike=(t,e)=>iter(t,n=>!e(n),(n,r,o)=>o),each=(t,e)=>iter(t,e,void 0,t),m=t=>s(t*60),map=(t,e=idem)=>{const n=type(t),r=empty(t);return iter(t,n==="string"?(o,i,f)=>(f.push(e(o,i,t)),f):n==="list"?(o,i,f)=>(f.push(e(o,i,t)),f):(o,i,f)=>(f[i]=e(o,i,t),f),n==="string"?o=>o.join(""):idem,r,r)},reduce=(t,e,n=void 0)=>iter(t,(r,o,i)=>{const f=e(i,r,o,t);return f===void 0?i:f},idem,n===void 0?empty(t):n,n),filter=(t,e=bool,n=idem)=>iter(t,type(t)==="list"?(r,o,i)=>(e(r,o,t)!==!1&&i.push(n(r,o)),i):(r,o,i)=>(e(r,o,t)!==!1&&(i[o]=n(r,o)),i),idem,empty(t),t),hasChanged=(t,e)=>!eq(t,e),list=t=>maptype(t,{null:e=>[],undefined:e=>[],list:idem,_:e=>{const n=e.length;if(typeof n=="number"){const o=[];for(var r=0;r<n;r++)o.push(e[r]);return o}else return[t]}}),len=t=>maptype(t,{list:e=>e.length,object:e=>typeof e.length=="number"?e.length:Object.keys(t).length,string:e=>e.length,_:1,null:e=>0,undefined:e=>0}),values=t=>maptype(t,{list:idem,object:e=>Object.values(t),_:[t],null:e=>[],undefined:e=>[]}),keys=t=>maptype(t,{list:e=>e.map((n,r)=>r),object:e=>Object.keys(t),_:[t],null:e=>[],undefined:e=>[]}),keyvalues=t=>items(t,!1),withClass=(t,e=document.body)=>{const n=e.classList.contains(t)?[e]:[];return each(e.querySelectorAll,r=>n.push(r)),n},copy=(()=>{const t=(e,n=1)=>n==0?e:e instanceof Node?e.cloneNode(!0):maptype(e,{string:idem,number:idem,null:r=>null,undefined:r=>{},_:r=>map(r,o=>t(o,n-1))});return t})(),mapkeys=(t,e)=>reduce(t,(n,r,o)=>{n[e(o,r)]=r},empty(t)),maplist=(t,e)=>reduce(t,(n,r,o,i)=>{n.push(e(r,o,i))},[]),rmerge=(()=>{const t=(e,n,r=-1)=>r===0?e:e==null?n:n===null||e===n?e:n instanceof Object&&e instanceof Object?reduce(n,(o,i,f)=>{o[f]=t(o[f],i,r>0?r-1:r)},e):n;return t})(),groupBy=(t,e,n=void 0)=>reduce(t,(r,o,i)=>{const f=e(o,i,t);return(r[f]=r[f]||[]).push(n?n(o):o),r},{}),partition=(t,e)=>(t instanceof Array?reduce(t,(n,r,o)=>{n[e(r,o)?0:1].push(r)},[[],[]]):reduce(t,(n,r,o)=>{n[e(r,o)?0:1][o]=r},[{},{}]))||[[],[]],enumerate=(...t)=>freeze(reduce(t,(e,n)=>(e[n]=n,e),{})),closest=(t,e,n=dist)=>reduce(t,(r,o,i)=>{const f=n(o,e);return(i===0||r.dist>f)&&(r.dist=f,r.value=o),r},{dist:void 0,value:void 0}).value,add=(t,e)=>t instanceof Array?reduce(t,(n,r)=>n+r,0):t+e,mul=(t,e)=>t instanceof Array?reduce(t,(n,r)=>n*r,1):t*e,toKebabCase=t=>reduce(t,(e,n)=>{e.push(n.toLowerCase())},[]).join("-"),describe=t=>{const e=reduce(t,(r,o,i)=>(r.min=Math.min(r.min===void 0?o:r.min,o),r.max=Math.max(r.max===void 0?o:r.min,o),r.total+=o,r.count+=1,r),{min:void 0,max:void 0,total:0,count:0,mean:0,variance:0,deviation:0,values:t});e.mean=e.total/e.count;let n=e.mean;return e.variance=reduce(t,(r,o,i)=>{const f=o-n;return r+f*f},0)/e.count,e.deviation=Math.sqrt(e.variance),e},unique=t=>{const e=[];return filter(t,n=>e.indexOf(n)!==-1?!1:e.push(n)||!0)},difference=(t,e)=>filter(t,n=>index(e,n)==-1),removeAt=(t,e)=>filter(t,(n,r)=>r!==e),iterable=t=>t instanceof Object?t:list(t),prepend=(()=>{const t=(e,n)=>{switch(type(e)){case"list":const r=e.slice();return r.splice(0,0,n),r;case"object":const o={};let i=0;for(;e[i]!==void 0;)i++;return o[i]=n,Object.assign(o,e),o;default:return t(list(e),n)}};return t})(),append=(()=>{const t=(e,n,r=!1)=>{switch(type(e)){case"list":const o=r?e:e.slice();return o.push(n),o;case"object":const i=r?e:Object.assign({},e);let f=Object.entries(i).length;for(;i[f]!==void 0;)f++;return i[f]=n,i;default:return t(list(e),n,r)}};return t})(),concat=(t,e)=>list(t).concat(list(e)),sorted=(t,e=void 0,n=1,r=cmp)=>{const o=typeof e=="function"?e:e?f=>f?f[e]:void 0:idem,i=t instanceof Array?[].concat(t):list(t);return i.sort((f,l)=>n*(e?r(o(f),o(l)):r(f,l))),i},itemize=t=>isMap(t)?reduce(t,(e,n,r)=>{e.push({label:r,key:r,index:e.length,value:n})},[]):list(t).map((e,n)=>merge({index:n,key:n},e&&e.value!==void 0?e:{value:e,label:str(e)})),minmax=(()=>{const t=(...e)=>e.length===1?list(e[0]).reduce((n,r,o)=>(o===0?n[0]=n[1]=r:(n[0]=min(n[0],r),n[1]=max(n[1],r)),n),[void 0,void 0]):t(e);return t})(),gradients=t=>reduce(list(t),(e,n,r,o)=>{r>0&&e.push(n-o[r-1])}),dom=(()=>{const t={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},e=(x,y)=>{const d=typeof y;if(y!=null){if(d==="string")x.appendChild(document.createTextNode(y));else if(d==="object"&&y.nodeType!==void 0)x.appendChild(y);else if(d==="object"&&y instanceof Array)for(let c=0;c<y.length;c++)e(x,y[c]);else{var u=!1;for(let c in y){let a=null,h=c.lastIndexOf(":"),p=y[c];p!==void 0&&(h>=0&&(a=c.substr(0,h),a=t[a]||a,c=c.substr(h+1,c.length)),(c=="_"||c=="_class"||c=="klass")&&(c="class"),a?setattr(x,c,p,0,a):c.startsWith("on")&&x[c]!==void 0?x[c]=p:setattr(x,c,p),u=!0)}u||x.appendChild(document.createTextNode(""+y))}return x}},n=x=>{for(;x.firstChild;)x.removeChild(x.firstChild);return x},r=(x,...y)=>e(n(x),...y),o=(x,...y)=>{var d=!0;return x.parentNode&&y.forEach(u=>{u===x&&(d=!1),x.parentNode&&x.parentNode.insertBefore(u,x)}),d&&x.parentNode&&x.removeChild(x),y},i=x=>(x&&x.parentNode&&x.parentNode.removeChild(x),x);return{namespaces:t,create:(x,y)=>{const d=document.createElement(x);for(var u=0;u<y.length;u++)e(d,y[u]);return d},createns:(x,y,d)=>{const u=document.createElementNS(x,y);for(var c=0;c<d.length;c++)e(u,d[c]);return u},set:r,append:e,clear:n,replace:o,unmount:i,remount:(x,y,d)=>{const u=x.parentNode;return each(list(d),i),each(list(y),u?c=>u.insertBefore(c,x):i),y}}})(),on=(t,e)=>Object.entries(e).forEach(([n,r])=>list(t).forEach(o=>o.addEventListener(n,r)))||t,off=(t,e)=>Object.entries(e).forEach(([n,r])=>list(t).forEach(o=>o.removeEventListener(n,r)))||t,combinations=(t,e=2)=>{const n=[],r=len(t);if(e>r)return n;const o=range(e);for(n.push(o.map(i=>t[i]));;){let i;for(let f=e-1;f>=0;f--)if(o[f]!==f+r-e){i=f;break}if(i===void 0)return n;o[i]+=1;for(let f=i+1;f<e;f++)o[f]=o[f-1]+1;n.push(o.map(f=>t[f]))}return n},stripe=t=>{const e=len(t),n=Math.floor(e/2);return array(e,r=>t[r<n?Math.min(e-1,r*2):Math.min(e-1,1+(r-n)*2)])},rmsd=(t,e=1)=>Math.sqrt(reduce(t,(n,r)=>n+sqdist(r,e),0)/len(t)),head=(t,e)=>{const n=values(t);return e===void 0||e===0?n[0]:n.slice(0,e<0?n.length+e:e)},nth=(t,e=0)=>{const n=values(t);return n[e<0?n.length+e:e]},set=(t,e,n)=>{const r=copy(t);if(t instanceof Array&&e instanceof Number){for(;r.length<e;)r.push(void 0);return r[e]=n,r}else return r[e]=n,r},insertAt=(t,e,n)=>{const r=type(t)==="list"?copy(t):list(t),o=e<0?r.length+e:e;return r.splice(o,0,n),r},sum=t=>reduce(t,add,0),toggle=(t,e)=>has(t,e)?remove(t,e):append(t,e),resize=(t,e,n=idem)=>{let r=len(t);if(r<e){const o=[];for(;r<e;)o.push((n||idem)(r++));return concat(t,o)}else return r>e?slice(t,0,e):t},flatten=(()=>{const t=(e,n=-1)=>n===0||!isCollection(e)?list(e):reduce(e,(r,o)=>concat(r,t(o,n-1)),[]);return t})(),maxmin=(...t)=>{const[e,n]=minmax(...t);return[n,e]},extent=t=>Math.abs(sub(minmax(t))),midpoint=t=>lerp(...minmax(t),.5),html=function(){const{create:t}=dom;return["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","map","mark","menu","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","slot","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","template","tfoot","th","thead","time","title","tr","tt","u","ul","video","wbr","xmp"].reduce((e,n)=>(e[n]=(...r)=>t(n,r),e),{...dom})}(),svg=function(){const{namespaces:t,createns:e}=dom,n=(r,o)=>e(t.svg,r,o);return["altglyph","altglyphdef","altglyphitem","animate","animatecolor","animatemotion","animatetransform","circle","clippath","colorProfile","cursor","defs","desc","ellipse","feblend","fecolormatrix","fecomponenttransfer","fecomposite","feconvolvematrix","fediffuselighting","fedisplacementmap","fedistantlight","feflood","fefunca","fefuncb","fefuncg","fefuncr","fegaussianblur","feimage","femerge","femergenode","femorphology","feoffset","fepointlight","fespecularlighting","fespotlight","fetile","feturbulence","filter","font","fontFace","fontFaceFormat","fontFaceName","fontFaceSrc","fontFaceUri","foreignobject","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","missingGlyph","mpath","path","pattern","polygon","polyline","radialgradient","rect","script","set","stop","style","svg","symbol","text","textpath","title","tref","tspan","use","view","vkern"].reduce((r,o)=>(r[o]=(...i)=>n(o,i),r),{...dom})}(),first=(t,e=null,n=idem)=>e?iter(t,(r,o)=>e?e(r,o,t)!==!0:!0,(r,o,i)=>n(t[i],i)):n(nth(t,0),0),last=t=>nth(t,-1),pick=t=>{const e=values(t);return nth(values(e),Math.round(Math.random()*(len(e)-1)))},mean=t=>sum(t)/len(t),clampsize=(t,e,n,r=idem)=>{const o=len(t);return o<e?resize(t,e,r):o>n?resize(t,n,r):t},grow=(t,e,n)=>isDef(e)?resize(t,max(e,len(t)),n):t,stylesheet=(t,e="default",n=!0)=>{const r=`stylesheet-${e||"default"}`,i=document.getElementById(r)||html.style({id:r,name:e}),f=()=>{const l=i.sheet;if(!l)return!1;for(;l&&l.cssRules&&l.cssRules.length;)l.deleteRule(0);return Object.entries(t).forEach(([g,x])=>{if(g==="@")each(x,y=>l.insertRule(`${x};`,0));else{const y=maptype(x,{object:d=>Object.entries(d).map(([u,c])=>`${u}: ${c};`).join(`
`),array:d=>d.join(`
`),_:str});l.insertRule(`${g} {${y}}`,0)}},l),!0};return!f()&&n&&until(()=>i.sheet&&i.sheet.cssRules,f,100,10),i},Slot=class{constructor(e){this.value=e,this.views=[],this.effects=[]}reduce(...e){const n=callable(this.value),r=e,o=()=>this.set(n(...map(r,i=>i.value),this.value));return this.value=void 0,each(r,i=>i.effect(o)),o(),this}set(e){const n=this.value;this.value=e,this.views.forEach(r=>{r.content=html.remount(r.node,r.render(e,n),r.content)}),this.effects.forEach(r=>r(e,n))}effect(e){this.effects.push(e)}view(e){if(!e)return;const n=document.createComment("view"),r={node:n,render:e,content:e(this.value,void 0)};return this.views.push(r),[n].concat(list(r.content))}},def=(...t)=>first(t,e=>e!==void 0),slot=(t,e)=>new Slot(t,e);
